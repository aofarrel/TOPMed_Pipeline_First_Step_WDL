# Significant differences between CWL and WDL versions

## Strictly Necessary Changes  
* Filenames are generated by calling the Seven Bridges API in the CWL. This isn't possible in WDL, so inputs are generated from JSONs instead.  

* The WDL relocalizes all files into the working directory in the unique variant IDs step, because otherwise generating a valid configuration file for the resulting R script seems to be impossible. Please just trust me on this one. I'm looking into an alternative fix.  

* The original CWL does not have an option for disk space, but the WDL does.  
	* Reasoning: AWS, the usual backend for SB, autoscales disk space. GCS, the backend for Terra, does not, so tasks will fail once they hit about 1 GB on GCS.

* The CWL generates config files using an InlineJavascriptRequirement, which is run before the CWL equivivalent of a task's command section begins. The WDL generates them using an inline Python script during the beginning of a task's command section.  
	* Reasoning: WDL lacks the option for running Javascript before a task's command section executes.

## "Not Strictly Necessary But In WDL This Makes More Sense"
* The WDL will not start the check_gds task if check_gds is false. The CWL will start the check_gds task regardless and generate a config file, and the true/false only applies to calling the R script.
	* Reasoning: The way GCS billing works, this has the potential of being cheaper. Otherwise we would spend for having a powerful non-preemptible compute designed for an intense task, then only using that compute for making a text file.

* The original CWL allocates memory and CPUs on an overall level, while the WDL does it on a task level. In other words, the WDL is more granular.  
	* Reasoning: GCS has stricter requirements than AWS regarding storage. Doing it this way also allows the check GDS step, which takes a lot more resources, to call more than the rest of the the WDL, saving money.

## Error Handling
* During check_gds, the WDL checks to ensure every gds file has a matching VCF during the creation of a configuration file. The CWL does not, allowing for the R script to make that check.
	* Reasoning: The R script correctly prints file not found errors, but they are printed before a false error about files have mismatching lines and it is easy to miss that error. This method of erroring might be slightly clearer.

* The WDL will consider "chromosome" a suitable replacement for "chr" in a filename for the second task, while the CWL will not.

* The WDL can correctly handle a mixture of file extensions, not so much by design, but due to the specifics of implementation. The CWL will handle such a mixture incorrectly in check_gds (but can correctly handle a homogenous group, such as all being bcf files) but correctly in previous tasks.

## Different Design Choices
* The CWL imports other CWLs. The WDL does not import other WDLs.  
	* Reasoning: It is possible for WDLs to contain just tasks and be imported into another task, but in some contexts it can be slightly less secure, especially if the imports are performed by calling another URL (which they would need to be if be ran on Terra).
